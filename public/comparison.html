<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction vs Reality Comparison</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1em;
            color: #666;
            font-weight: 500;
        }

        .accuracy-high { color: #28a745; }
        .accuracy-medium { color: #ffc107; }
        .accuracy-low { color: #dc3545; }

        .filters {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #eee;
        }

        .filter-group {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group label {
            font-weight: 500;
            color: #555;
        }

        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .matches-container {
            padding: 30px;
        }

        .match-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .match-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .match-teams {
            font-size: 1.3em;
            font-weight: 600;
        }

        .match-league {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .match-content {
            padding: 25px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .prediction-section, .actual-section, .accuracy-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .section-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .prediction-section .section-title {
            color: #667eea;
        }

        .actual-section .section-title {
            color: #28a745;
        }

        .accuracy-section .section-title {
            color: #dc3545;
        }

        .score-display {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .winner-display {
            font-size: 1.2em;
            font-weight: 600;
            margin: 10px 0;
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
        }

        .winner-home { background: #d4edda; color: #155724; }
        .winner-away { background: #f8d7da; color: #721c24; }
        .winner-draw { background: #fff3cd; color: #856404; }

        .accuracy-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: 600;
            margin: 5px;
        }

        .accuracy-correct { background: #d4edda; color: #155724; }
        .accuracy-incorrect { background: #f8d7da; color: #721c24; }
        .accuracy-partial { background: #fff3cd; color: #856404; }

        .confidence-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin: 5px;
        }

        .confidence-high { background: #d4edda; color: #155724; }
        .confidence-medium { background: #fff3cd; color: #856404; }
        .confidence-low { background: #f8d7da; color: #721c24; }

        .risk-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin: 5px;
        }

        .risk-low { background: #d4edda; color: #155724; }
        .risk-medium { background: #fff3cd; color: #856404; }
        .risk-high { background: #f8d7da; color: #721c24; }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }

        .error {
            text-align: center;
            padding: 50px;
            color: #dc3545;
            font-size: 1.2em;
        }

        .nav-links {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
        }

        .nav-links a {
            display: inline-block;
            padding: 10px 20px;
            margin: 0 10px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            transition: background 0.3s ease;
        }

        .nav-links a:hover {
            background: #5a6fd8;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .match-header {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Prediction vs Reality</h1>
            <p>Comparing our Bayesian predictions with actual match results</p>
        </div>

        <div class="nav-links">
            <a href="/">‚Üê Back to Analysis</a>
            <a href="/comparison.html">Refresh Data</a>
        </div>

        <div class="stats-grid" id="statsGrid">
            <div class="loading">Loading comparison data...</div>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label for="accuracyFilter">Accuracy:</label>
                <select id="accuracyFilter">
                    <option value="all">All Results</option>
                    <option value="correct">Correct Predictions</option>
                    <option value="incorrect">Incorrect Predictions</option>
                </select>

                <label for="confidenceFilter">Confidence:</label>
                <select id="confidenceFilter">
                    <option value="all">All Levels</option>
                    <option value="high">High Confidence</option>
                    <option value="medium">Medium Confidence</option>
                    <option value="low">Low Confidence</option>
                </select>

                <label for="searchInput">Search Teams:</label>
                <input type="text" id="searchInput" placeholder="Enter team name...">
            </div>
        </div>

        <div class="matches-container" id="matchesContainer">
            <div class="loading">Loading match comparisons...</div>
        </div>
    </div>

    <script>
        let comparisonData = null;

        async function loadComparisonData() {
            try {
                console.log('Loading comparison data...');
                const response = await fetch('/data/comparison_2025_08_14.json?t=' + Date.now());
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error(`Failed to load comparison data: ${response.status} ${response.statusText}`);
                }
                comparisonData = await response.json();
                console.log('Comparison data loaded:', comparisonData);
                displayStats();
                displayMatches();
            } catch (error) {
                console.error('Error loading comparison data:', error);
                document.getElementById('statsGrid').innerHTML = 
                    '<div class="error">Error loading comparison data: ' + error.message + '</div>';
                document.getElementById('matchesContainer').innerHTML = 
                    '<div class="error">Error loading match data: ' + error.message + '</div>';
            }
        }

        function displayStats() {
            try {
                const stats = comparisonData;
                const statsGrid = document.getElementById('statsGrid');
                
                if (!stats || !statsGrid) {
                    console.error('Stats data or element not found');
                    return;
                }
                
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${stats.completedMatches || 0}</div>
                        <div class="stat-label">Completed Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number accuracy-${getAccuracyClass(stats.accuracy?.winner || 0)}">${stats.accuracy?.winner || 0}%</div>
                        <div class="stat-label">Winner Accuracy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number accuracy-${getAccuracyClass(stats.accuracy?.score || 0)}">${stats.accuracy?.score || 0}%</div>
                        <div class="stat-label">Score Accuracy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number accuracy-${getAccuracyClass(stats.accuracy?.overUnder || 0)}">${stats.accuracy?.overUnder || 0}%</div>
                        <div class="stat-label">Over/Under Accuracy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.confidenceAnalysis?.high?.total || 0}</div>
                        <div class="stat-label">High Confidence Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.confidenceAnalysis?.medium?.total || 0}</div>
                        <div class="stat-label">Medium Confidence Matches</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error displaying stats:', error);
                document.getElementById('statsGrid').innerHTML = 
                    '<div class="error">Error displaying statistics: ' + error.message + '</div>';
            }
        }

        function getAccuracyClass(accuracy) {
            if (accuracy >= 70) return 'high';
            if (accuracy >= 40) return 'medium';
            return 'low';
        }

        function displayMatches() {
            try {
                const container = document.getElementById('matchesContainer');
                if (!container) {
                    console.error('Matches container not found');
                    return;
                }
                
                if (!comparisonData || !comparisonData.predictions) {
                    console.error('Comparison data or predictions not found');
                    container.innerHTML = '<div class="error">No comparison data available</div>';
                    return;
                }
                
                const accuracyFilter = document.getElementById('accuracyFilter').value;
                const confidenceFilter = document.getElementById('confidenceFilter').value;
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();

                let filteredMatches = comparisonData.predictions;

            // Apply filters
            if (accuracyFilter === 'correct') {
                filteredMatches = filteredMatches.filter(match => match.accuracy.winner);
            } else if (accuracyFilter === 'incorrect') {
                filteredMatches = filteredMatches.filter(match => !match.accuracy.winner);
            }

            if (confidenceFilter !== 'all') {
                filteredMatches = filteredMatches.filter(match => 
                    (match.prediction.confidence || 'medium').toLowerCase() === confidenceFilter
                );
            }

            if (searchTerm) {
                filteredMatches = filteredMatches.filter(match => 
                    match.homeTeam.toLowerCase().includes(searchTerm) ||
                    match.awayTeam.toLowerCase().includes(searchTerm)
                );
            }

            if (filteredMatches.length === 0) {
                container.innerHTML = '<div class="loading">No matches found with current filters.</div>';
                return;
            }

            container.innerHTML = filteredMatches.map(match => `
                <div class="match-card">
                    <div class="match-header">
                        <div>
                            <div class="match-teams">${match.homeTeam} vs ${match.awayTeam}</div>
                            <div class="match-league">${match.league}</div>
                        </div>
                        <div>
                            <span class="confidence-badge confidence-${(match.prediction.confidence || 'medium').toLowerCase()}">
                                ${match.prediction.confidence || 'MEDIUM'} Confidence
                            </span>
                            <span class="risk-badge risk-${(match.prediction.riskLevel || 'medium').toLowerCase()}">
                                ${match.prediction.riskLevel || 'MEDIUM'} Risk
                            </span>
                        </div>
                    </div>
                    <div class="match-content">
                        <div class="comparison-grid">
                            <div class="prediction-section">
                                <div class="section-title">Our Prediction</div>
                                <div class="score-display">${match.prediction.score || 'N/A'}</div>
                                <div class="winner-display winner-${match.prediction.winner || 'draw'}">
                                    ${getWinnerText(match.prediction.winner || 'draw')}
                                </div>
                                <div>Over/Under: ${match.prediction.overUnder || 'N/A'}</div>
                                <div>Home Win: ${match.prediction.homeWinProb || 0}%</div>
                                <div>Draw: ${match.prediction.drawProb || 0}%</div>
                                <div>Away Win: ${match.prediction.awayWinProb || 0}%</div>
                            </div>
                            <div class="actual-section">
                                <div class="section-title">Actual Result</div>
                                <div class="score-display">${match.actual.score || 'N/A'}</div>
                                <div class="winner-display winner-${match.actual.winner || 'draw'}">
                                    ${getWinnerText(match.actual.winner || 'draw')}
                                </div>
                                <div>Status: ${match.actual.status || 'N/A'}</div>
                            </div>
                            <div class="accuracy-section">
                                <div class="section-title">Accuracy</div>
                                <div>
                                    <span class="accuracy-indicator ${(match.accuracy.winner || false) ? 'accuracy-correct' : 'accuracy-incorrect'}">
                                        Winner: ${(match.accuracy.winner || false) ? '‚úì' : '‚úó'}
                                    </span>
                                </div>
                                <div>
                                    <span class="accuracy-indicator ${(match.accuracy.score || 0) >= 50 ? 'accuracy-correct' : 'accuracy-incorrect'}">
                                        Score: ${match.accuracy.score || 0}%
                                    </span>
                                </div>
                                <div>
                                    <span class="accuracy-indicator ${(match.accuracy.overUnder || false) ? 'accuracy-correct' : 'accuracy-incorrect'}">
                                        Over/Under: ${(match.accuracy.overUnder || false) ? '‚úì' : '‚úó'}
                                    </span>
                                </div>
                                <div>
                                    <span class="accuracy-indicator accuracy-${getAccuracyClass(match.accuracy.overall || 0)}">
                                        Overall: ${match.accuracy.overall || 0}%
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        } catch (error) {
            console.error('Error displaying matches:', error);
            const container = document.getElementById('matchesContainer');
            if (container) {
                container.innerHTML = '<div class="error">Error displaying matches: ' + error.message + '</div>';
            }
        }
        }

        function getWinnerText(winner) {
            switch(winner) {
                case 'home': return 'Home Win';
                case 'away': return 'Away Win';
                case 'draw': return 'Draw';
                default: return winner;
            }
        }

        // Event listeners for filters
        document.getElementById('accuracyFilter').addEventListener('change', displayMatches);
        document.getElementById('confidenceFilter').addEventListener('change', displayMatches);
        document.getElementById('searchInput').addEventListener('input', displayMatches);

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, starting to load comparison data...');
            loadComparisonData();
        });
        
        // Fallback: try to load data after a short delay if initial load fails
        setTimeout(() => {
            if (!comparisonData) {
                console.log('Retrying comparison data load...');
                loadComparisonData();
            }
        }, 2000);
    </script>
</body>
</html> 